{% extends "index.html" %}

{% block title %}{{ page.title }}{% endblock title %}
{% block description %}{{ page.description | default(value=config.description) }}{% endblock description %}

{% block header %}
<header class="space space-jam" >
    <a href="{{ config.base_url }}">&LeftArrow; home</a>
    <a href="/projects">projects &RightArrow;</a>
</header>
{% endblock header %}

{% block content %}
<main>
    <h1>{{ page.title }}</h1>
    {% if page.date or page.taxonomies %}
    <p class="secondary small">
        {% if page.date %}{{ page.date | date(format="%-d %B, %Y") }}{% endif %}

        {% set_global sorted_taxonomies = [] %}
        {% for taxonomy_name, _ in page.taxonomies %}
        {% set_global sorted_taxonomies = sorted_taxonomies | concat(with=taxonomy_name) %}
        {% endfor %}
        {% set_global sorted_taxonomies = sorted_taxonomies | sort %}

        {% for taxonomy_name in sorted_taxonomies %}
        {% set terms = page.taxonomies[taxonomy_name] %}
        {% if not terms %}{% continue %}{% endif %}
        - {{ taxonomy_name | capitalize }}:
        {% for term_name in terms %}
        {% set term = get_taxonomy_term(kind=taxonomy_name, term=term_name) %}
        <a href="{{ term.permalink }}">{{ term.name }}</a>{% if not loop.last %},{% endif %}
        {% endfor %}
        {% endfor %}
    </p>
    {% endif %}
    <div class="space"></div>
    {{ page.content | safe }}

    {% set proj_section = get_section(path="projects/_index.md") %}
    {% set pages = proj_section.pages %}
    {% set last = pages | last %}
    {% set first = pages | first %}

    <nav class="space-up space-jam">
        {% if page.higher %}
        <a href="{{ page.higher.permalink }}">&LeftArrow; {{ page.higher.title }}</a>
        {% else %}
        <a href="{{ first.permalink }}">&LeftArrow; {{ first.title }}</a>
        {% endif %}
        {% if page.lower %}
        <a href="{{ page.lower.permalink }}">{{ page.lower.title }} &RightArrow;</a>
        {% else %}
        <a href="{{ last.permalink }}">{{ last.title }} &RightArrow;</a>
        {% endif %}
    </nav>
</main>
{% endblock content %}

